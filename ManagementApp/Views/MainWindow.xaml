<Window x:Class="ManagementApp.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ManagementApp.Views"
        xmlns:controls="clr-namespace:ManagementApp.Controls"
        mc:Ignorable="d"
        Title="سیستم مدیریت شیفت کارمندان" 
        WindowState="Maximized"
        FlowDirection="LeftToRight"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <!-- EmployeePhotoConverter will be added in code-behind -->
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2E3440" Padding="10">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="سیستم مدیریت شیفت کارمندان" 
                          FontFamily="Tahoma" 
                          FontSize="18" 
                          FontWeight="Bold" 
                          Foreground="White" 
                          VerticalAlignment="Center"/>
                <TextBlock Text="{Binding CurrentDate}" 
                          FontFamily="Tahoma" 
                          FontSize="14" 
                          Foreground="LightGray" 
                          VerticalAlignment="Center" 
                          Margin="20,0,0,0"/>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <TabControl x:Name="MainTabControl" Grid.Row="1" Margin="10" SelectionChanged="MainTabControl_SelectionChanged">
            <TabItem Header="مدیریت کارمندان">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="3*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Employee List -->
                    <GroupBox Grid.Column="0" Header="لیست کارمندان" Margin="5">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Search Box -->
                            <TextBox Grid.Row="0" 
                                    x:Name="EmployeeSearchBox"
                                    Text="جستجو..." 
                                    Foreground="Gray"
                                    Margin="5"/>
                            
                            <!-- Employee List -->
                            <ListBox Grid.Row="1" 
                                    x:Name="EmployeeListBox"
                                    DisplayMemberPath="FullName"
                                    SelectionChanged="EmployeeListBox_SelectionChanged"
                                    Margin="5"/>

                            <!-- Employee Actions -->
                            <StackPanel Grid.Row="2" Orientation="Vertical" Margin="5">
                                <Button Content="افزودن کارمند" Click="AddEmployee_Click" Margin="2"/>
                                <Button Content="ویرایش کارمند" Click="EditEmployee_Click" Margin="2"/>
                                <Button Content="حذف کارمند" Click="DeleteEmployee_Click" Margin="2"/>
                                <Button Content="مدیریت نقش‌ها" Click="ManageRoles_Click" Margin="2" Background="#9C27B0" Foreground="White"/>
                                <Button Content="مدیریت گروه‌های شیفت" Click="ManageShiftGroups_Click" Margin="2" Background="#FF5722" Foreground="White"/>
                                <Button Content="وارد کردن از CSV" Click="ImportCSV_Click" Margin="2"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Splitter 1 -->
                    <GridSplitter Grid.Column="1" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Employee Details -->
                    <GroupBox Grid.Column="2" Header="جزئیات کارمند" Margin="5">
                        <Grid x:Name="EmployeeDetailsGrid" Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Label Grid.Row="0" Grid.Column="0" Content="نام:"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="FirstNameTextBox" Margin="5"/>

                            <Label Grid.Row="1" Grid.Column="0" Content="نام خانوادگی:"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="LastNameTextBox" Margin="5"/>

                            <Label Grid.Row="2" Grid.Column="0" Content="سمت:"/>
                            <ComboBox Grid.Row="2" Grid.Column="1" x:Name="RoleComboBox" Margin="5"/>

                            <Label Grid.Row="3" Grid.Column="0" Content="نقش مدیر:"/>
                            <CheckBox Grid.Row="3" Grid.Column="1" x:Name="IsManagerCheckBox" Content="این کارمند مدیر است" Margin="5"/>

                            <Label Grid.Row="4" Grid.Column="0" Content="عکس:"/>
                            <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Margin="5">
                                <Button Content="انتخاب عکس" Click="SelectPhoto_Click" Margin="0,0,5,0"/>
                                <Button Content="ذخیره تغییرات" Click="SaveEmployeeChanges_Click"/>
                            </StackPanel>

                            <!-- Employee Photo -->
                            <Image Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" 
                                  x:Name="EmployeePhoto" 
                                  Width="200" Height="200" 
                                  Stretch="Uniform"
                                  Margin="10"/>
                        </Grid>
                    </GroupBox>

                    <!-- Splitter 2 -->
                    <GridSplitter Grid.Column="3" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Absence Management -->
                    <GroupBox Grid.Column="4" Header="مدیریت غیبت" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="نوع غیبت:"/>
                            <ComboBox x:Name="AbsenceTypeComboBox" Margin="0,5">
                                <ComboBoxItem Content="مرخصی"/>
                                <ComboBoxItem Content="بیمار"/>
                                <ComboBoxItem Content="غایب"/>
                            </ComboBox>

                            <Label Content="تاریخ غیبت:" Margin="0,10,0,5"/>
                            <controls:GeorgianDatePicker x:Name="AbsenceDatePicker" Margin="0,0,0,10"/>

                            <Label Content="توضیحات:" Margin="0,10,0,5"/>
                            <TextBox x:Name="AbsenceNotesTextBox" 
                                    Height="60" 
                                    TextWrapping="Wrap" 
                                    AcceptsReturn="True"
                                    Margin="0,0,0,10"/>

                            <Button Content="ثبت غیبت" Click="MarkAbsent_Click" Margin="0,5"/>
                            <Button Content="حذف غیبت" Click="RemoveAbsence_Click" Margin="0,5"/>

                            <!-- Absence List -->
                            <Label Content="لیست غیبت‌ها:" Margin="0,20,0,5"/>
                            <ListBox x:Name="AbsenceListBox" 
                                    Height="150" 
                                    Margin="0,5">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding CategoryDisplay}" Width="80" Margin="5,0"/>
                                            <TextBlock Text="{Binding DateDisplay}" Width="120" Margin="5,0"/>
                                            <TextBlock Text="{Binding Notes}" Width="100" Margin="5,0" TextTrimming="CharacterEllipsis"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="مدیریت شیفت">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Employee List for Shift Assignment -->
                    <GroupBox Grid.Column="0" Header="کارمندان" Margin="5">
                        <ListBox x:Name="ShiftEmployeeListBox" 
                                AllowDrop="True"
                                DragOver="Employee_DragOver"
                                PreviewMouseLeftButtonDown="ShiftEmployeeListBox_PreviewMouseLeftButtonDown"
                                MouseMove="ShiftEmployeeListBox_MouseMove"
                                Margin="5">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Name="EmployeeCardBorder"
                                            Background="White"
                                            BorderBrush="#CCCCCC"
                                            BorderThickness="1"
                                            CornerRadius="4"
                                            Padding="8"
                                            Margin="2"
                                            Cursor="Hand">
                                        <StackPanel Orientation="Vertical"
                                                   HorizontalAlignment="Center">
                                            <Image x:Name="EmployeePhotoImage"
                                                   Width="50"
                                                   Height="50"
                                                   Stretch="UniformToFill"
                                                   Margin="0,0,0,5"/>
                                            <TextBlock Text="{Binding FullName}"
                                                      FontFamily="Tahoma"
                                                      FontSize="10"
                                                      TextAlignment="Center"
                                                      TextWrapping="Wrap"
                                                      MaxWidth="100"
                                                      Foreground="DarkBlue"
                                                      HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </GroupBox>

                    <!-- Splitter 1 -->
                    <GridSplitter Grid.Column="1" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Shift Assignment -->
                    <GroupBox Grid.Column="2" Header="تخصیص شیفت" Margin="5">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Display Group Selection -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                                <Label Content="گروه نمایش:"/>
                                <ComboBox x:Name="DisplayGroupComboBox" Width="150" Margin="5,0" 
                                         SelectionChanged="DisplayGroupComboBox_SelectionChanged"/>
                                <TextBlock Text="(کنترل نمایش در DisplayApp)" FontSize="10" 
                                          Foreground="Gray" VerticalAlignment="Center" Margin="5,0"/>
                            </StackPanel>

                            <!-- Shift Group Selection -->
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
                                <Label Content="گروه شیفت:"/>
                                <ComboBox x:Name="ShiftGroupComboBox" Width="150" Margin="5,0" 
                                         SelectionChanged="ShiftGroupComboBox_SelectionChanged"/>
                            </StackPanel>

                            <!-- Shift Controls -->
                            <StackPanel Grid.Row="2" Orientation="Vertical" Margin="5">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                    <Label Content="ظرفیت شیفت:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="ShiftCapacityTextBox" Width="50" Text="15" Margin="5,0" VerticalAlignment="Center"/>
                                    <Button Content="تغییر ظرفیت" Click="ChangeCapacity_Click" Margin="5,0"/>
                                    <Button Content="پاک کردن شیفت صبح" Click="ClearMorningShift_Click" Margin="5,0"/>
                                    <Button Content="پاک کردن شیفت عصر" Click="ClearEveningShift_Click" Margin="5,0"/>
                                    <Button Content="جابجایی شیفت‌ها" Click="SwapShifts_Click" Margin="5,0"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox x:Name="AutoRotateCheckBox" 
                                              Content="جابجایی خودکار هر شنبه" 
                                              Checked="AutoRotateCheckBox_Checked" 
                                              Unchecked="AutoRotateCheckBox_Unchecked"
                                              Margin="0,0,5,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Shift Slots -->
                            <Grid Grid.Row="3" Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Morning Shift -->
                                <GroupBox Grid.Column="0" Header="شیفت صبح" Margin="5">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                        <StackPanel x:Name="MorningShiftPanel" Margin="5"/>
                                    </ScrollViewer>
                                </GroupBox>

                                <!-- Evening Shift -->
                                <GroupBox Grid.Column="1" Header="شیفت عصر" Margin="5">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                        <StackPanel x:Name="EveningShiftPanel" Margin="5"/>
                                    </ScrollViewer>
                                </GroupBox>
                            </Grid>

                            <!-- Shift Statistics -->
                            <StackPanel Grid.Row="4" Orientation="Horizontal" Margin="5">
                                <Label Content="شیفت صبح:"/>
                                <TextBlock x:Name="MorningShiftStats" Text="0/15" Margin="5,0"/>
                                <Label Content="شیفت عصر:"/>
                                <TextBlock x:Name="EveningShiftStats" Text="0/15" Margin="5,0"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Splitter 2 -->
                    <GridSplitter Grid.Column="3" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Absence List -->
                    <GroupBox Grid.Column="4" Header="کارمندان غایب" Margin="5">
                        <ListBox x:Name="AbsentEmployeeListBox" 
                                DisplayMemberPath="FullName"
                                Margin="5"/>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="مدیریت وظایف">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Task List -->
                    <GroupBox Grid.Column="0" Header="لیست وظایف" Margin="5">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Task Filter -->
                            <ComboBox Grid.Row="0" x:Name="TaskFilterComboBox" Margin="5">
                                <ComboBoxItem Content="همه وظایف"/>
                                <ComboBoxItem Content="در انتظار"/>
                                <ComboBoxItem Content="در حال انجام"/>
                                <ComboBoxItem Content="تکمیل شده"/>
                            </ComboBox>

                            <!-- Task List -->
                            <ListBox Grid.Row="1" 
                                    x:Name="TaskListBox"
                                    DisplayMemberPath="Title"
                                    SelectionChanged="TaskListBox_SelectionChanged"
                                    Margin="5"/>

                            <!-- Task Actions -->
                            <StackPanel Grid.Row="2" Orientation="Vertical" Margin="5">
                                <Button Content="افزودن وظیفه" Click="AddTask_Click" Margin="2"/>
                                <Button Content="ویرایش وظیفه" Click="EditTask_Click" Margin="2"/>
                                <Button Content="حذف وظیفه" Click="DeleteTask_Click" Margin="2"/>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <!-- Splitter -->
                    <GridSplitter Grid.Column="1" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Task Details -->
                    <GroupBox Grid.Column="2" Header="جزئیات وظیفه" Margin="5">
                        <Grid x:Name="TaskDetailsGrid" Margin="10">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Label Grid.Row="0" Grid.Column="0" Content="عنوان:"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="TaskTitleTextBox" Margin="5"/>

                            <Label Grid.Row="1" Grid.Column="0" Content="توضیحات:"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="TaskDescriptionTextBox" 
                                    Height="60" TextWrapping="Wrap" AcceptsReturn="True" Margin="5"/>

                            <Label Grid.Row="2" Grid.Column="0" Content="اولویت:"/>
                            <ComboBox Grid.Row="2" Grid.Column="1" x:Name="TaskPriorityComboBox" Margin="5">
                                <ComboBoxItem Content="کم"/>
                                <ComboBoxItem Content="متوسط" IsSelected="True"/>
                                <ComboBoxItem Content="زیاد"/>
                                <ComboBoxItem Content="فوری"/>
                            </ComboBox>

                            <Label Grid.Row="3" Grid.Column="0" Content="ساعت تخمینی:"/>
                            <TextBox Grid.Row="3" Grid.Column="1" x:Name="TaskEstimatedHoursTextBox" Text="1.0" Margin="5"/>

                            <Label Grid.Row="4" Grid.Column="0" Content="تاریخ هدف:"/>
                            <controls:GeorgianDatePicker Grid.Row="4" Grid.Column="1" x:Name="TaskTargetDatePicker" Margin="5"/>

                            <Label Grid.Row="5" Grid.Column="0" Content="وضعیت:"/>
                            <ComboBox Grid.Row="5" Grid.Column="1" x:Name="TaskStatusComboBox" Margin="5">
                                <ComboBoxItem Content="در انتظار"/>
                                <ComboBoxItem Content="در حال انجام"/>
                                <ComboBoxItem Content="تکمیل شده"/>
                            </ComboBox>

                            <StackPanel Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" 
                                       Orientation="Horizontal" Margin="5">
                                <Button Content="ذخیره تغییرات" Click="SaveTaskChanges_Click" Margin="0,0,5,0"/>
                                <Button Content="شروع وظیفه" Click="StartTask_Click" Margin="0,0,5,0"/>
                                <Button Content="تکمیل وظیفه" Click="CompleteTask_Click" Margin="0,0,5,0"/>
                            </StackPanel>

                            <!-- Task Assignment -->
                            <GroupBox Grid.Row="7" Grid.Column="0" Grid.ColumnSpan="2" Header="تخصیص کارمند" Margin="5">
                                <Grid Margin="10">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Label Grid.Row="0" Grid.Column="0" Content="کارمندان تخصیص داده شده:"/>
                                    <ListBox Grid.Row="1" Grid.Column="0" x:Name="AssignedEmployeesListBox" 
                                            Height="80" Margin="0,5,5,0">
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding DisplayText}" Width="200" Margin="5,0"/>
                                                    <Button Content="حذف" Width="50" Height="20" FontSize="10"
                                                            Click="RemoveEmployeeFromTask_Click" Tag="{Binding EmployeeId}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                    
                                    <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Vertical" Margin="5,5,0,0">
                                        <Button Content="تخصیص کارمند جدید" Click="AddEmployeeToTask_Click" 
                                                Width="140" Height="30" Margin="0,0,0,5"/>
                                        <Button Content="مشاهده وظایف کارمند" Click="ViewEmployeeTasks_Click" 
                                                Width="140" Height="30"/>
                                    </StackPanel>
                                </Grid>
                            </GroupBox>

                            <!-- Task Progress -->
                            <GroupBox Grid.Row="8" Grid.Column="0" Grid.ColumnSpan="2" Header="پیشرفت وظیفه" Margin="5">
                                <StackPanel Margin="10">
                                    <Label Content="ساعات واقعی:"/>
                                    <TextBox x:Name="TaskActualHoursTextBox" Margin="0,5"/>
                                    <Label Content="یادداشت‌ها:"/>
                                    <TextBox x:Name="TaskNotesTextBox" 
                                            Height="60" 
                                            TextWrapping="Wrap" 
                                            AcceptsReturn="True"
                                            Margin="0,5"/>
                                </StackPanel>
                            </GroupBox>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="گزارش‌گیری">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Report Options -->
                    <GroupBox Grid.Column="0" Header="گزینه‌های گزارش" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="نوع گزارش:"/>
                            <ComboBox x:Name="ReportTypeComboBox" Margin="0,5">
                                <ComboBoxItem Content="گزارش روزانه"/>
                                <ComboBoxItem Content="گزارش هفتگی"/>
                                <ComboBoxItem Content="گزارش ماهانه"/>
                            </ComboBox>

                            <Label Content="تاریخ شروع:" Margin="0,10,0,5"/>
                            <controls:GeorgianDatePicker x:Name="ReportStartDatePicker" Margin="0,0,0,10"/>

                            <Label Content="تاریخ پایان:" Margin="0,0,0,5"/>
                            <controls:GeorgianDatePicker x:Name="ReportEndDatePicker" Margin="0,0,0,10"/>

                            <Label Content="مسئول گزارش:" Margin="0,10,0,5"/>
                            <ComboBox x:Name="ReportAssignedToComboBox" Margin="0,0,0,10"/>

                            <Button Content="تولید گزارش" Click="GenerateReport_Click" Margin="0,10"/>
                            <Button Content="صادر کردن" Click="ExportReport_Click" Margin="0,5"/>
                            
                            <!-- Performance Calculation Formula Tooltip -->
                            <Border Background="#F5F5F5" BorderBrush="#CCCCCC" BorderThickness="1" 
                                    CornerRadius="5" Margin="0,15,0,0" Padding="8">
                                <StackPanel>
                                    <TextBlock Text="ℹ️ فرمول محاسبه عملکرد:" 
                                               FontWeight="Bold" FontSize="11" 
                                               Foreground="#333" Margin="0,0,0,5"/>
                                    <TextBlock Text="عملکرد پایه (70) + کارمندان (×2) + شیفت (×3) - غیبت (×2) + تغییرات روزانه (±12)" 
                                               FontSize="10" Foreground="#666" 
                                               TextWrapping="Wrap" LineHeight="16"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>

                    <!-- Splitter -->
                    <GridSplitter Grid.Column="1" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Report Preview -->
                    <GroupBox Grid.Column="2" Header="پیش‌نمایش گزارش" Margin="5">
                        <ScrollViewer>
                            <TextBlock x:Name="ReportPreviewTextBlock" 
                                      FontFamily="Tahoma" 
                                      FontSize="12" 
                                      TextWrapping="Wrap" 
                                      Margin="10"/>
                        </ScrollViewer>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="تنظیمات">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Settings Options -->
                    <GroupBox Grid.Column="0" Header="تنظیمات سیستم" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="مسیر پوشه داده‌ها:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBox x:Name="DataDirectoryTextBox" 
                                        Width="300" 
                                        IsReadOnly="True"
                                        Margin="0,0,5,0"/>
                                <Button Content="انتخاب پوشه" 
                                        Click="SelectDataDirectory_Click" 
                                        Width="100"/>
                            </StackPanel>

                            <Label Content="مسیر فعلی:" Margin="0,0,0,5"/>
                            <TextBlock x:Name="CurrentDataDirectoryTextBlock" 
                                      TextWrapping="Wrap" 
                                      Foreground="Gray" 
                                      Margin="0,0,0,10"/>

                            <CheckBox x:Name="CopyExistingDataCheckBox" 
                                     Content="انتقال داده‌های موجود به مکان جدید" 
                                     IsChecked="True"
                                     Margin="0,0,0,10"/>

                            <StackPanel x:Name="ProgressPanel" Visibility="Collapsed" Margin="0,0,0,10">
                                <Label Content="در حال انتقال داده‌ها..." FontWeight="Bold"/>
                                <ProgressBar x:Name="DataCopyProgressBar" 
                                            Height="20" 
                                            IsIndeterminate="True"/>
                            </StackPanel>

                            <Button Content="ذخیره تنظیمات" 
                                    Click="SaveSettings_Click" 
                                    Background="#4CAF50" 
                                    Foreground="White" 
                                    FontWeight="Bold"
                                    Margin="0,10"/>
                            
                            <Button Content="بازنشانی به پیش‌فرض" 
                                    Click="ResetSettings_Click" 
                                    Background="#FF9800" 
                                    Foreground="White" 
                                    Margin="0,5"/>

                            <Separator Margin="0,20,0,10"/>

                            <Label Content="تنظیمات شیفت:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                <Label Content="ظرفیت پیش‌فرض:" Width="120"/>
                                <TextBox x:Name="DefaultShiftCapacityTextBox" 
                                        Width="60" 
                                        Text="15"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                <Label Content="فاصله همگام‌سازی (ثانیه):" Width="120"/>
                                <TextBox x:Name="SyncIntervalTextBox" 
                                        Width="60" 
                                        Text="30"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <!-- Splitter -->
                    <GridSplitter Grid.Column="1" 
                                 ResizeDirection="Columns"
                                 Width="5"
                                 Background="#CCCCCC"
                                 HorizontalAlignment="Stretch"
                                 VerticalAlignment="Stretch"
                                 ShowsPreview="False"
                                 Margin="0"/>

                    <!-- Settings Information -->
                    <GroupBox Grid.Column="2" Header="اطلاعات سیستم" Margin="5">
                        <StackPanel Margin="10">
                            <Label Content="وضعیت همگام‌سازی:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock x:Name="SyncStatusTextBlock" 
                                      Text="فعال" 
                                      Foreground="Green" 
                                      Margin="0,0,0,20"/>

                            <Label Content="آخرین به‌روزرسانی:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBlock x:Name="LastUpdateTextBlock" 
                                      Text="--" 
                                      Margin="0,0,0,20"/>

                            <Label Content="فایل‌های گزارش موجود:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ListBox x:Name="ReportFilesListBox" 
                                    Height="150" 
                                    Margin="0,0,0,20"/>

                            <Label Content="لاگ‌های سیستم:" FontWeight="Bold" Margin="0,0,0,5"/>
                            <ScrollViewer Height="200" VerticalScrollBarVisibility="Auto">
                                <TextBlock x:Name="SystemLogsTextBlock" 
                                          FontFamily="Consolas" 
                                          FontSize="10" 
                                          TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Background="#ECEFF4">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="آماده" FontFamily="Tahoma"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="{Binding CurrentTime}" FontFamily="Tahoma"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
